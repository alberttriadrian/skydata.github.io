<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Data Visualization</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/stylish-portfolio.css" rel="stylesheet">
	<link href="css/override.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    


</head>

<body>
    <!-- Navigation -->
    <nav id="main_nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header nav">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
					<i class="fa fa-bars"></i>
				</button>
				<a class="navbar-brand page-scroll" href="index.html">
					<b><i class="fa fa-play-circle"></i> <span class="light">Home</span> Kelompok 3</b>
				</a>
			</div>

			<div class="collapse navbar-collapse navbar-right navbar-main-collapse">
				<ul class="nav navbar-nav">
					<!-- Hidden li included to remove active class from Data Visualization link when scrolled up past Data Visualization section -->
					<li class="hidden">
						<a href="#page-top"></a>
					</li>
					<li>
						<a class="navbar-brand page-scroll" href="coal.html">
							<b><i class="fa fa-play-circle"></i> <span class="light">Data Visualization</b>
						</a>
					</li>
					<li>
						<a class="navbar-brand page-scroll" href="coal.html">
							<b><i class="fa fa-play-circle"></i> <span class="light">About Us</b>
						</a>
					</li>
					<li>
						<a id="menu-toggle" href="#" class="btn btn-dark btn-lg toggle" width="200px"><i class="fa fa-bars"></i></a>
					</li>
				</ul>
			</div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>
    
    <!-- Navigation Box Content -->
    <nav id="sidebar-wrapper">
        <ul class="sidebar-nav">
            <a id="menu-close" href="#" class="btn btn-light btn-lg pull-right toggle"><i class="fa fa-times"></i></a>
            <li class="sidebar-brand">
                <a href="#top"  onclick = $("#menu-close").click(); >SkyData Visualization</a>
            </li>
            <li>
                <a href="#top" onclick = $("#menu-close").click(); >Home</a>
            </li>
            <li>
                <a href="#about" onclick = $("#menu-close").click(); >About</a>
            </li>
            <li>
                <a href="#services" onclick = $("#menu-close").click(); >Services</a>
            </li>
            <li>
                <a href="#portfolio" onclick = $("#menu-close").click(); >Team</a>
            </li>
            <li>
                <a href="#contact" onclick = $("#menu-close").click(); >Contact</a>
            </li>
        </ul>
    </nav>

    <!-- About -->
    <section id="about" class="about">
    </section>
    
    <div class="row">
		<div class="col-lg-10 col-md-offset-1">  
			<div class="input-group">
				<span class="input-group-btn">
					<button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Data Visualization Coal Sector
					  <span class="caret"></span>
					</button>
					<ul class="dropdown-menu">
					  <li><a id="1coal" onclick="coalSector(id)">coal_ekspor</a></li>
					  <li><a id="2coal" onclick="coalSector(id)">coal_production</a></li>
					  <li><a id="3coal" onclick="coalSector(id)">coal_domestic-selling</a></li>
					  <li><a id="4coal" onclick="coalSector(id)">coal_stock</a></li>
					</ul>
				</span>
				<input type="text" class="form-control" id="coal_sector" placeholder="Input your coal sector data  ..." value="">
			</div>
		</div>
	</div><br>
    

	  <div class="col-lg-10 col-md-offset-1">
		<button class="btn btn-danger" id="add-button"><span class=" glyphicon glyphicon-plus" aria-hidden="true"></span> Add</button>
		<button class="btn btn-warning" id="delete-button"><span class=" glyphicon glyphicon-minus" aria-hidden="true"></span> Delete</button>
	  </div><br><br>

	

	<div id="input_place_parent">
		<p id="input_place"></p>
	</div>
	
	<div class="col-lg-10 col-md-offset-1">
		<button class="btn btn-primary" id="chart-button"><span class=" glyphicon glyphicon-signal" aria-hidden="true"></span> Chart</button>
		<button class= "btn btn-info"id="bar-button"><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Bar</button>
	</div>
	
    <!-- The Data Visualization Implementation -->	
	<div id="visualization_place" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
	
    <!-- Call to Action -->
    <aside class="call-to-action bg-primary">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h1>Visualization from the Blue Sky</h1>
                    <a href="#" class="btn btn-lg btn-dark">Sky</a>
                    <a href="#" class="btn btn-lg btn-dark">Data</a>
                </div>
            </div>
        </div>
    </aside>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1 text-center">
                    <h4><strong>SkyData Visualization</strong>
                    </h4>
                    <p>Lie, Albert Tri Adrian<br>Informatics Engineering ITB ,Bandung, Indonesia</p>
                    <ul class="list-unstyled">
                        <li><i class="fa fa-phone fa-fw"></i> (+62) 81901596260</li>
                        <li><i class="fa fa-envelope-o fa-fw"></i>  <a href="mailto:alberttri23@gmail.com">alberttri23@gmail.com</a>
                        </li>
                    </ul>
                    <br>
                    <ul class="list-inline">
                        <li>
                            <a href="#"><i class="fa fa-facebook fa-fw fa-3x"></i></a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-twitter fa-fw fa-3x"></i></a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-dribbble fa-fw fa-3x"></i></a>
                        </li>
                    </ul>
                    <hr class="small">
                    <p class="text-muted">Copyright &copy; SkyData Visualization</p>
                </div>
            </div>
        </div>
    </footer>
    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Custom Theme JavaScript -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://code.highcharts.com/modules/exporting.js"></script>
	<script id="1coal_sector_file" type="text/javascript" src="data/coal_ekspor.json"></script>
	<script id="2coal_sector_file" type="text/javascript" src="data/coal_production.json"></script>
	<script id="3coal_sector_file" type="text/javascript" src="data/coal_domestic-selling.json"></script>
	<script id="4coal_sector_file" type="text/javascript" src="data/coal_stock.json"></script>
    
    <script>
		
	var years = ['2003', '2004', '2005', '2006', '2007', '2008','2009', '2010'];
	var input = [];
	
	var mycoal;
	var allNames;
	var allNameList;
	
	var coal_sector_id = 0;
	var coal_sector_title="";
	var names;
	var values;

	var value1;
	var value2;
	var value3;
	var value4;

	var input_index = 1;
	var input_add;
	
	//Add the input box, the company name
    $("button#add-button").click(function(){
		if (input_index <= 4){
			getListCompanyName(input_index);
	
			var input_add = "<br id=\"company_parent" +input_index +"\"><div id=\"company_parent" + input_index + "\" class=\"row\"><div class=\"col-lg-10 col-md-offset-1\"> <div class=\"input-group\">" +
				"<span class=\"input-group-btn\">" + "<button type=\"button\" class=\"btn btn-success dropdown-toggle\"" +
				" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">" +
				"Company Name " + input_index + "<span class=\"caret\"></span>" + 
				"</button><ul class=\"dropdown-menu\">" + allNameList + "</ul></span>" + 
				"<input type=\"text\" class=\"form-control\" id=\"company"+ input_index +"\" placeholder=\"Input your company name ...\">" +  
				"</div></div></div>";	
			$(input_add).insertBefore("p#input_place");
			input_index++;
		}
    });
   
	//Delete the input box, the company name
    $("button#delete-button").click(function(){
		if (input_index > 1){
			$("div#company_parent" + (input_index-1) ).remove();
			$("br#company_parent" + (input_index-1) ).remove();
			input_index--;		
		}
    });

    function listValue(id){
		document.getElementById("company" + id.charAt(0)).value = document.getElementById(id.toString()).innerHTML;		
	}
	
	function coalSector(id){
		document.getElementById("coal_sector").value = document.getElementById(id.toString()).innerHTML;	
		//document.getElementById("coal_sector_file").src = "data/" + document.getElementById(id.toString()).innerHTML + ".json";			
		coal_sector_id = parseInt(id.charAt(0));
		allNames = loadAllName();
		coal_sector_title = document.getElementById(id.toString()).innerHTML;

	}
    
    //Line Chart
	$(function () {
		//Submit the company name
		
		$("button#chart-button").click(function(){
			dataToVisualization();	
			$('#visualization_place').highcharts({
				title: {
					text: coal_sector_title + ' in Indonesia 2003 - 2010',
					x: -20 //center
				},
				subtitle: {
					text: 'Source: <a href="http://data.go.id/">Portal Data Indonesia</a>',
					x: -20
				},
				xAxis: {
					title:{
						text: 'Years'
					},
					categories: years
				},
				yAxis: {
					title: {
						text: 'Coal Units (units)'
					},
					plotLines: [{
						value: 0,
						width: 1,
						color: '#808080'
					}]
				},
				tooltip: {
					valueSuffix: 'units'
				},
				legend: {
					layout: 'vertical',
					align: 'right',
					verticalAlign: 'middle',
					borderWidth: 0
				},
				series: [{
					name: names[0],
					data: value1
				}, {
					name: names[8],
					data: value2
				}, {
					name: names[16],
					data: value3
				}, {
					name: names[24],
					data: value4
				}]
			});
		});	
		
		$("button#bar-button").click(function(){
			var point_width = 8;
			
			dataToVisualization();	
			$('#visualization_place').highcharts({
				chart: {
					type: 'bar'
				},
				title: {
					text: coal_sector_title + ' in Indonesia 2003 - 2010',
					x: -20
				},
				subtitle: {
					text: 'Source: <u><a href="http://data.go.id/">Portal Data Indonesia</a></u>'
				},
				xAxis: {
					categories: ['2003', '2004', '2005', '2006', '2007', '2008',
						'2009', '2010'],
					title: {
						text: 'Years'
					}
				},
				yAxis: {
					min: 0,
					title: {
						text: 'Coal Units (units)',
						x : -20
					},
					labels: {
						overflow: 'justify'
					}
				},
				tooltip: {
					valueSuffix: ' millions'
				},
				plotOptions: {
					bar: {
						dataLabels: {
							enabled: true
						}
					}
				},
				legend: {
					layout: 'vertical',
					align: 'right',
					verticalAlign: 'top',
					x: -40,
					y: 80,
					floating: true,
					borderWidth: 1,
					backgroundColor: ((Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'),
					shadow: true
				},
				credits: {
					enabled: false
				},
				series: [{
					name: names[0],
					data: value1,
					pointWidth: point_width
				}, {
					name: names[8],
					data: value2,
					pointWidth: point_width
				}, {
					name: names[16],
					data: value3,
					pointWidth: point_width				
				}, {
					name: names[24],
					data: value4,
					pointWidth: point_width
				}]
			});
		});
	});
	

    // Closes the sidebar menu
    $("#menu-close").click(function(e) {
        e.preventDefault();
        $("#sidebar-wrapper").toggleClass("active");
    });

    // Opens the sidebar menu
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#sidebar-wrapper").toggleClass("active");
    });

    // Scrolls to the selected menu item on the page
    $(function() {
        $('a[href*=#]:not([href=#])').click(function() {
            if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') || location.hostname == this.hostname) {

                var target = $(this.hash);
                target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
                if (target.length) {
                    $('html,body').animate({
                        scrollTop: target.offset().top
                    }, 1000);
                    return false;
                }
            }
        });
	});	
	
	function dataToVisualization(){
		input = [];

		names = [];
		values = [];

		value1 = [];
		value2 = [];
		value3 = [];
		value4 = [];
		
		for (var i = 0 ; i < input_index - 1 ; i++){
			var companyId = "company" + (i + 1);
			var x =  document.getElementById(companyId).value;
			input.push(x);
		}

		names = loadName();
		values = loadValue();			
			
		splitValue();		
	}

	function loadData(){
		if (coal_sector_id == 1){
			mycoal = JSON.parse(coal_ekspor_data);
		}
		else if (coal_sector_id == 2){
			mycoal = JSON.parse(coal_production_data);			
		}
		else if (coal_sector_id == 3){
			mycoal = JSON.parse(coal_domesticselling_data);			
		}
		else if (coal_sector_id == 4){
			mycoal = JSON.parse(coal_stock_data);			
		}
	}
	
	function loadValue() {
		loadData();
		
		var value = [];
		var i;
		for (i = 0; i < mycoal.length; i++) {
			var j; 
			for (j = 0; j < input.length; j++ ){
				if (mycoal[i].nama_entitas == input[j]){
					if (mycoal[i].nilai != ""){
						value.push(parseInt(mycoal[i].nilai));					
					}
					else{
						value.push(0);
					}
				}
			}
		}	
		return value;
	}		
	
	function loadName() {
		loadData();
		
		var text = [];
		var i;
		for (i = 0; i < mycoal.length; i++) {
			var j; 
			for (j = 0; j < input.length; j++ ){
				if (mycoal[i].nama_entitas == input[j]){
					text.push(mycoal[i].nama_entitas);					
				}
			}
		}	
		return text;
	}	

	function loadAllName() {
		loadData();
		
		var text = [];
		var i;
		var count = 0;
		for (i = 0; i < mycoal.length; i++) {
			if (count == 0){
				text.push(mycoal[i].nama_entitas);
			}
			else if(count == 8){
				text.push(mycoal[i].nama_entitas);
				count = 0;
			}
			count++;
		}	
		return text;
	}	
	
	function splitValue(){
		var len = input.length;
		if (len == 1 ){
			splitValue1();
		}
		else if (len == 2){
			splitValue1();
			splitValue2();
		}
		else if (len == 3){
			splitValue1();
			splitValue2();
			splitValue3();
		}
		else{
			splitValue1();
			splitValue2();
			splitValue3();
			splitValue4();
		}
	}
	
	function splitValue1(){
		for (var i = 0 ; i < 8 ; i++){
			value1.push(values[i]);
		}		
	}
	
	function splitValue2(){
		for (var i = 8 ; i < 16 ; i++){
			value2.push(values[i]);
		}	
	}
	
	function splitValue3(){
		for (var i = 16 ; i < 24 ; i++){
			value3.push(values[i]);
		}	
	}

	function splitValue4(){
		for (var i = 24 ; i < 32 ; i++){
			value4.push(values[i]);
		}	
	}	
	
	function getListCompanyName(num){
		allNameList = "";
		for (var i = 0 ; i < allNames.length; i++){
			var str = "<li><a id=\"" + num + "-"+ (i+1) + "\" onclick=\"listValue(id)\">" + allNames[i] +"</a></li>";
			allNameList += str;							
		}		
	}
	
    </script>

</body>

</html>

